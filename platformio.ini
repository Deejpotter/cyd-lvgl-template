; PlatformIO Project Configuration File

[platformio]
src_dir = src
default_envs = jc2432w328r

[env]
platform = espressif32@6.5.0
board = esp32dev
framework = arduino
lib_ldf_mode = deep
lib_deps = 
	bodmer/TFT_eSPI@^2.5.42
	https://github.com/PaulStoffregen/XPT2046_Touchscreen.git 
	lvgl/lvgl@^8.3.6
	adafruit/DHT sensor library@^1.4.4
	lovyan03/LovyanGFX @ ^1.0.0
monitor_speed = 115200
monitor_filters = esp32_exception_decoder
upload_speed = 921600
board_build.partitions = min_spiffs.csv
build_flags =
	-I./src/
	-I./src/ui/
	-DUSER_SETUP_LOADED
	-DLOAD_FONT2
	-DLOAD_FONT4
	-DLOAD_FONT6
	-DLOAD_FONT7
	-DLOAD_FONT8
	-DLOAD_GFXFF
extra_scripts = pre:scripts/copy_template.py

[env:jc2432w328r]
build_flags =
	${env.build_flags}
	-DTFT_INVERSION_OFF
	-DST7789_2_DRIVER
	-DUSE_VSPI_PORT
	-DTFT_WIDTH=240
	-DTFT_HEIGHT=320
	-DTFT_MISO=12
	-DTFT_MOSI=13
	-DTFT_SCLK=14
	-DTFT_CS=15
	-DTFT_DC=2
	-DTFT_RST=-1
	-DTFT_BL=27
	-DTOUCH_CS=33 ; Enable touch
	-DTFT_BACKLIGHT_ON=HIGH
	-DTFT_BACKLIGHT_OFF=LOW
	-DLOAD_GLCD
	-DSPI_FREQUENCY=40000000
	-DSPI_READ_FREQUENCY=20000000
	-DSPI_TOUCH_FREQUENCY=2500000
	-DMODEL_JC2432W328R
	-DTOUCH_TYPE_RESISTIVE ; Macro for resistive touch

; Notes:
; - All hardware-specific flags for JC2432W328R moved here
; - Use this env for the resistive touch (XPT2046) 2.8" CYD model

[env:jc2432w328c]
build_flags =
	${env.build_flags}
	-DTFT_INVERSION_OFF
	-DI2C_SDA=21
	-DI2C_SCL=22
	-DCST820_TOUCH ; Capacitive touch controller (assumed CST820, update if needed)
	-DMODEL_JC2432W328C
	-DST7789_2_DRIVER
	-DUSE_VSPI_PORT
	-DTFT_WIDTH=240
	-DTFT_HEIGHT=320
	-DTFT_MISO=12
	-DTFT_MOSI=13
	-DTFT_SCLK=14
	-DTFT_CS=15
	-DTFT_DC=2
	-DTFT_RST=-1
	-DTFT_BL=27
	-DTFT_BACKLIGHT_ON=HIGH
	-DTFT_BACKLIGHT_OFF=LOW
	-DLOAD_GLCD
	-DSPI_FREQUENCY=40000000
	-DSPI_READ_FREQUENCY=20000000
	-DTOUCH_TYPE_CAPACITIVE ; Macro for capacitive touch

; Notes:
; - I2C_SDA/I2C_SCL set to IO21/IO22 per GitHub issue and typical ESP32 pinout
; - Touch controller assumed CST820 (update if confirmed otherwise)
; - Display driver ST7789, same as R model
; - Other pins (SPI, BL, etc.) assumed same as R model unless confirmed different
